metadata:
   name: attach-logs
   maintainer:
      - Michael Hudson-Doyle <michael.hudson@linaro.org>
   format: "Lava-Test-Shell Test Definition 1.0"
   version: 1.0
   description: ""
   os:
      - ubuntu
   devices:
      - mustang
   environment:
      - lava-test-shell


run:
  steps:
    - "set -x"
    - "mount /dev/sda1 /mnt"
    - "set +e"
    - "cd /mnt/home/ubuntu"
    - "lava-test-run-attach tempest-logs.txt"
    - "cd /mnt/opt/stack/log"
    - "tar -czf ../log.tar.gz ."
    - "cd .."
    - "lava-test-run-attach log.tar.gz"
    - "cd /mnt/opt/stack/logs && tar -czf ../logs.tar.gz . && cd .."
    - "lava-test-run-attach logs.tar.gz"
